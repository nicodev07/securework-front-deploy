"use strict";(self.webpackChunksecurework_front=self.webpackChunksecurework_front||[]).push([[310],{9310:(st,N,v)=>{v.r(N),v.d(N,{ProfesionalModule:()=>it});var u=v(9808),p=v(8578),d=v(5861),e=v(4893),x=v(1100),g=v(5888),b=v(5459),I=v(520),C=v(4464),k=v(1665),_=v(1553);let y=(()=>{class r{constructor(t,i,s){this.configService=t,this.httpClient=i,this.localSecureService=s,this.headers=new I.WM({Accept:"application/json","Content-Type":"application/json; charset=utf-8"})}setHeaders(t){const i=this.localSecureService.getValue("currentUser"),s=i?`${i.token}`:"";let o=this.headers.set("ApiKey",t);return o=o.set("Authorization",`Bearer ${s}`),o}RevisarClientes(t){var i=this;return(0,d.Z)(function*(){try{const s=yield i.configService.getConfig(),a=`${s.api_url}/Profesional/RevisarClientes?idProfesional=${t}`,l=i.setHeaders(s.apikey);return yield(0,C.n)(i.httpClient.get(a,{headers:l}))}catch(s){return{status:!1,code:null==s?void 0:s.status,message:null==s?void 0:s.statusText}}})()}GetCapacitaciones(t){var i=this;return(0,d.Z)(function*(){try{const s=yield i.configService.getConfig(),o=`${s.api_url}/Profesional/GetCapacitaciones`,a=i.setHeaders(s.apikey);return yield(0,C.n)(i.httpClient.post(o,t,{headers:a}))}catch(s){return{status:!1,code:null==s?void 0:s.status,message:null==s?void 0:s.statusText}}})()}CrearCapacitacion(t){var i=this;return(0,d.Z)(function*(){try{const s=yield i.configService.getConfig(),o=`${s.api_url}/Profesional/CrearCapacitacion`,a=i.setHeaders(s.apikey);return yield(0,C.n)(i.httpClient.post(o,t,{headers:a}))}catch(s){return{status:!1,code:null==s?void 0:s.status,message:null==s?void 0:s.statusText}}})()}GetVisitas(t){var i=this;return(0,d.Z)(function*(){try{const s=yield i.configService.getConfig(),o=`${s.api_url}/Profesional/GetVisitas`,a=i.setHeaders(s.apikey);return yield(0,C.n)(i.httpClient.post(o,t,{headers:a}))}catch(s){return{status:!1,code:null==s?void 0:s.status,message:null==s?void 0:s.statusText}}})()}CrearVisita(t){var i=this;return(0,d.Z)(function*(){try{const s=yield i.configService.getConfig(),o=`${s.api_url}/Profesional/CrearVisita`,a=i.setHeaders(s.apikey);return yield(0,C.n)(i.httpClient.post(o,t,{headers:a}))}catch(s){return{status:!1,code:null==s?void 0:s.status,message:null==s?void 0:s.statusText}}})()}GetAsesorias(t){var i=this;return(0,d.Z)(function*(){try{const s=yield i.configService.getConfig(),o=`${s.api_url}/Profesional/GetAsesorias`,a=i.setHeaders(s.apikey);return yield(0,C.n)(i.httpClient.post(o,t,{headers:a}))}catch(s){return{status:!1,code:null==s?void 0:s.status,message:null==s?void 0:s.statusText}}})()}IngresarAsesoria(t){var i=this;return(0,d.Z)(function*(){try{const s=yield i.configService.getConfig(),o=`${s.api_url}/Profesional/IngresarAsesoria`,a=i.setHeaders(s.apikey);return yield(0,C.n)(i.httpClient.post(o,t,{headers:a}))}catch(s){return{status:!1,code:null==s?void 0:s.status,message:null==s?void 0:s.statusText}}})()}RevisarActividad(t){var i=this;return(0,d.Z)(function*(){try{const s=yield i.configService.getConfig(),a=`${s.api_url}/Profesional/RevisarActividades?idVisita=${t}`,l=i.setHeaders(s.apikey);return yield(0,C.n)(i.httpClient.get(a,{headers:l}))}catch(s){return{status:!1,code:null==s?void 0:s.status,message:null==s?void 0:s.statusText}}})()}IngresarActividad(t){var i=this;return(0,d.Z)(function*(){try{const s=yield i.configService.getConfig(),o=`${s.api_url}/Profesional/IngresarActividad`,a=i.setHeaders(s.apikey);return yield(0,C.n)(i.httpClient.post(o,t,{headers:a}))}catch(s){return{status:!1,code:null==s?void 0:s.status,message:null==s?void 0:s.statusText}}})()}GetChecklists(t){var i=this;return(0,d.Z)(function*(){try{const s=yield i.configService.getConfig(),o=`${s.api_url}/Profesional/GetChecklists`,a=i.setHeaders(s.apikey);return yield(0,C.n)(i.httpClient.post(o,t,{headers:a}))}catch(s){return{status:!1,code:null==s?void 0:s.status,message:null==s?void 0:s.statusText}}})()}CrearChecklist(t){var i=this;return(0,d.Z)(function*(){try{const s=yield i.configService.getConfig(),o=`${s.api_url}/Profesional/CrearChecklist`,a=i.setHeaders(s.apikey);return yield(0,C.n)(i.httpClient.post(o,t,{headers:a}))}catch(s){return{status:!1,code:null==s?void 0:s.status,message:null==s?void 0:s.statusText}}})()}ResponderChecklist(t){var i=this;return(0,d.Z)(function*(){try{const s=yield i.configService.getConfig(),o=`${s.api_url}/Profesional/ResponderChecklist`,a=i.setHeaders(s.apikey);return yield(0,C.n)(i.httpClient.put(o,t,{headers:a}))}catch(s){return{status:!1,code:null==s?void 0:s.status,message:null==s?void 0:s.statusText}}})()}GetAlertas(t){var i=this;return(0,d.Z)(function*(){try{const s=yield i.configService.getConfig(),o=`${s.api_url}/Profesional/GetAlertas`,a=i.setHeaders(s.apikey);return yield(0,C.n)(i.httpClient.post(o,t,{headers:a}))}catch(s){return{status:!1,code:null==s?void 0:s.status,message:null==s?void 0:s.statusText}}})()}CrearCasoAsesoria(t){var i=this;return(0,d.Z)(function*(){try{const s=yield i.configService.getConfig(),o=`${s.api_url}/Profesional/CrearCasoAsesoria`,a=i.setHeaders(s.apikey);return yield(0,C.n)(i.httpClient.post(o,t,{headers:a}))}catch(s){return{status:!1,code:null==s?void 0:s.status,message:null==s?void 0:s.statusText}}})()}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(k.E),e.LFG(I.eN),e.LFG(_.b))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var Z=v(7996);const U=function(r,n){return{"mx-auto":r,active:n}};function V(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",13),e.NdJ("click",function(){const o=e.CHM(t).$implicit;return e.oxw().redirect(o.url)}),e.TgZ(2,"h4"),e._uU(3),e.qZA()(),e.BQk()}if(2&r){const t=n.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngClass",e.WLB(2,U,"menu"!==i.path,t.target.toLowerCase()===i.path)),e.xp6(2),e.Oqu(t.target)}}const J=function(){return["/profesional"]},P=function(r){return{"flex-xl-row":r}};let S=(()=>{class r{constructor(t,i,s,o){this.router=t,this.route=i,this.dataSecureService=s,this.localSecureService=o}ngOnInit(){var t;this.path=null===(t=this.route.routeConfig)||void 0===t?void 0:t.path,this.checkIdClient()}checkIdClient(){const t=this.route.snapshot.queryParams.cliente;this.cliente=t?this.dataSecureService.objectDecrypt(t):null,this.user=this.localSecureService.getValue("currentUser"),this.cliente?this.getOptions():this.router.navigate(["/profesional"])}getOptions(){this.options=[{id:1,target:"Capacitaciones",url:"/profesional/capacitaciones"},{id:2,target:"Visitas",url:"/profesional/visitas"},{id:3,target:"Asesor\xedas",url:"/profesional/asesorias"},{id:4,target:"CheckList",url:"/profesional/checklist"},{id:5,target:"Alertas",url:"/profesional/alertas"}]}redirect(t){const i=this.dataSecureService.encrypt(this.cliente);this.router.navigate([t],{queryParams:{cliente:i}}).then(()=>{})}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.F0),e.Y36(p.gz),e.Y36(g.X),e.Y36(_.b))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-navbar"]],decls:16,vars:7,consts:[[1,"container-fluid"],[1,"card"],[1,"card-header","mt-2"],[1,"row"],[1,"col-xl-6"],[1,"text-dark","text-start"],[1,"col-xl-6","text-end"],[1,"btn","btn-primary","text-white",3,"routerLink"],[1,"c-icon","fas","fa-arrow-left"],[1,"card-body","mt-2"],[1,"col-xl-8","mx-auto"],[1,"nav","nav-pills","flex-column",3,"ngClass"],[4,"ngFor","ngForOf"],["type","button","data-coreui-toggle","pill",1,"btn","btn-outline-primary",3,"ngClass","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h4",5),e._uU(6),e.qZA()(),e.TgZ(7,"div",6)(8,"button",7),e._UZ(9,"i",8),e._uU(10,"\xa0\xa0\xa0Listado Clientes "),e.qZA()()()(),e.TgZ(11,"div",9)(12,"div",3)(13,"div",10)(14,"div",11),e.YNc(15,V,4,5,"ng-container",12),e.qZA()()()()()()),2&t&&(e.xp6(6),e.hij("",null==i.cliente?null:i.cliente.razonSocial," "),e.xp6(2),e.Q6J("routerLink",e.DdM(4,J)),e.xp6(6),e.Q6J("ngClass",e.VKq(5,P,"menu"!==i.path)),e.xp6(1),e.Q6J("ngForOf",i.options))},directives:[p.rH,u.mk,u.sg],styles:[""]}),r})();var A=v(6936),c=v(2382);function D(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"i",13),e._uU(2," Por favor, selecciona una fecha. "),e.qZA())}function Q(r,n){if(1&r&&(e.TgZ(0,"div",11),e.YNc(1,D,3,0,"div",12),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.fecha.errors.required)}}function B(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"i",13),e._uU(2," Por favor, ingrese descripci\xf3n. "),e.qZA())}function E(r,n){if(1&r&&(e.TgZ(0,"div",11),e.YNc(1,B,3,0,"div",12),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.descripcion.errors.required)}}const F=function(r){return{"is-invalid":r}};let M=(()=>{class r{constructor(t,i,s,o,a,l,f,m,h){this.router=t,this.datePipe=i,this.route=s,this.formBuilder=o,this.authService=a,this.dataSecureService=l,this.sweetAlertService=f,this.profesionalService=m,this.localSecureService=h,this.hideView=new e.vpe,this.isSubmitted=!1,this.fileBase64=""}ngOnInit(){this.checkIdClient()}get f(){return this.formulario.controls}checkIdClient(){const t=this.route.snapshot.queryParams.cliente;this.cliente=t?this.dataSecureService.objectDecrypt(t):null,this.cliente?(this.user=this.localSecureService.getValue("currentUser"),this.initForm()):this.router.navigate(["/profesional"])}initForm(){this.formulario=this.formBuilder.group({fecha:["",c.kI.required],descripcion:["",c.kI.required],archivo:[""]}),this.setForm()}setForm(){const t=new Date,i=t.setDate(t.getDate()+1);this.minDate=this.datePipe.transform(i,"yyyy-MM-dd"),this.formulario.patchValue({fecha:this.datePipe.transform(i,"yyyy-MM-dd")})}onSubmit(){this.isSubmitted=!0,!this.formulario.invalid&&this.ingresarActividad()}ingresarActividad(){var t=this;return(0,d.Z)(function*(){t.sweetAlertService.swalLoading();const i={fechaActividad:t.f.fecha.value,descripcion:t.f.descripcion.value,documentoB64:null==t.fileBase64?null:t.fileBase64,idVisita:t.idVisita},s=yield t.profesionalService.IngresarActividad(i);t.sweetAlertService.swalClose(),s.success?(yield t.sweetAlertService.swalInfo("success","\xc9xito","Actividad ingresada"),t.redirect()):(401===s.code||0===s.code)&&t.authService.sessionExpired()})()}readFile(t){const i=t.target.files[0],s=new FileReader;s.readAsDataURL(i),s.onload=()=>{var o,a;const l=null===(o=s.result)||void 0===o?void 0:o.toString();this.fileBase64=null===(a=null==l?void 0:l.split(","))||void 0===a?void 0:a[1]}}redirect(){this.hideView.emit()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.F0),e.Y36(u.uU),e.Y36(p.gz),e.Y36(c.qu),e.Y36(x.e),e.Y36(g.X),e.Y36(b.T),e.Y36(y),e.Y36(_.b))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-form-actividad"]],inputs:{idVisita:"idVisita"},outputs:{hideView:"hideView"},decls:20,vars:10,consts:[[1,"row"],[1,"col-xl-10","mx-auto"],[1,"row",3,"formGroup","ngSubmit"],[1,"col-xl-4","mx-auto","my-4"],["type","date","placeholder","DD/MM/AAAA","formControlName","fecha",1,"form-control","text-center",3,"min","ngClass"],["class","invalid-feedback",4,"ngIf"],[1,"col-xl-6","mx-auto","my-4"],["type","text","formControlName","descripcion","cols","30","rows","10",1,"form-control",3,"ngClass"],["type","file","id","formFile",1,"form-control",3,"change"],[1,"col-xl-12","text-center","mt-5"],["type","submit",1,"btn","btn-primary"],[1,"invalid-feedback"],[4,"ngIf"],[1,"far","fa-times-circle"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(3,"div",3)(4,"h6"),e._uU(5,"Fecha Actividad"),e.qZA(),e._UZ(6,"input",4),e.YNc(7,Q,2,1,"div",5),e.qZA(),e.TgZ(8,"div",6)(9,"h6"),e._uU(10,"Descripci\xf3n"),e.qZA(),e._UZ(11,"textarea",7),e.YNc(12,E,2,1,"div",5),e.qZA(),e.TgZ(13,"div",6)(14,"h6"),e._uU(15,"Seleccionar Archivo"),e.qZA(),e.TgZ(16,"input",8),e.NdJ("change",function(o){return i.readFile(o)}),e.qZA()(),e.TgZ(17,"div",9)(18,"button",10),e._uU(19,"Guardar"),e.qZA()()()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",i.formulario),e.xp6(4),e.Q6J("min",i.minDate)("ngClass",e.VKq(6,F,i.isSubmitted&&i.f.fecha.invalid)),e.xp6(1),e.Q6J("ngIf",i.isSubmitted&&i.f.fecha.errors),e.xp6(4),e.Q6J("ngClass",e.VKq(8,F,i.isSubmitted&&i.f.descripcion.errors)),e.xp6(1),e.Q6J("ngIf",i.isSubmitted&&i.f.descripcion.errors))},directives:[c._Y,c.JL,c.sg,c.Fj,c.JJ,c.u,u.mk,u.O5],styles:[""]}),r})();function O(r,n){1&r&&(e.TgZ(0,"div",12)(1,"h4"),e._uU(2," Sin registros de actividad "),e.qZA()())}function H(r,n){if(1&r&&(e.TgZ(0,"div",13),e._UZ(1,"app-datatable",14),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.Tol("table-bordered border fs-6"),e.Q6J("columnas",t.columns)("data",t.data)("dom",t.dom)("buttons",t.buttons)}}function $(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2)(2,"div",3)(3,"div",4),e._UZ(4,"div",5),e.TgZ(5,"div",6)(6,"button",7),e.NdJ("click",function(){return e.CHM(t),e.oxw().read=!1}),e._UZ(7,"i",8),e._uU(8,"\xa0\xa0\xa0Crear Actividad "),e.qZA()()()(),e.TgZ(9,"div",9)(10,"div",4),e.YNc(11,O,3,0,"div",10),e.YNc(12,H,2,6,"div",11),e.qZA()()(),e.BQk()}if(2&r){const t=e.oxw();e.xp6(11),e.Q6J("ngIf",0===t.data.length),e.xp6(1),e.Q6J("ngIf",t.data.length>0)}}function L(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2)(2,"div",9)(3,"app-form-actividad",15),e.NdJ("hideView",function(){return e.CHM(t),e.oxw().refreshView()}),e.qZA()()(),e.BQk()}if(2&r){const t=e.oxw();e.xp6(3),e.Q6J("idVisita",t.idVisita)}}let G=(()=>{class r{constructor(t,i,s,o,a,l,f,m,h){this.router=t,this.datePipe=i,this.route=s,this.authService=o,this.dataSecureService=a,this.sweetAlertService=l,this.profesionalService=f,this.localSecureService=m,this.emitDataService=h,this.data=[],this.columns=[],this.dom="",this.buttons=[],this.read=!0}ngOnInit(){this.validaUser()}validaUser(){var t=this;return(0,d.Z)(function*(){t.user=t.localSecureService.getValue("currentUser"),3===t.user.idPerfil?t.checkIdClient():(yield t.sweetAlertService.swalInfo("warning","\xa1Lo sentimos!","No posee los permisos necesarios para ver este \xedtem."))&&t.router.navigate(["/dashboard"])})()}checkIdClient(){const t=this.route.snapshot.queryParams.cliente;this.cliente=t?this.dataSecureService.objectDecrypt(t):null,this.cliente?this.revisarActividad(!1):this.router.navigate(["/profesional"])}getColumnas(){this.dom='<"row"<"col-xl-6"B><"col-xl-6"f>><"row"<"col-xl-12"tr>><"row"<"col-xl-4"i><"col-xl-4"l><"col-xl-4"p>>',this.columns=[{title:"Fecha de actividad",data:"fechaActividad",className:"dt-center dt-body-left",render:t=>this.datePipe.transform(t,"dd-MM-yyyy")},{title:"Descripci\xf3n",data:"descripcion",className:"dt-center dt-body-left",orderable:!1},{title:"Ver Documento",data:"documento",className:"dt-center",orderable:!1,render:t=>(null==t?void 0:t.length)>0?`<a download=pdfDocument href="data:application/pdf;base64,${t}">\n                        <button class="btn bg-primary text-white btn-sm" type="submit" title="Documento" value="">\n                          <i class="fa-solid fa-file-pdf pe-none"></i> \n                        </button>\n                      </a>`:""}]}revisarActividad(t){var i=this;return(0,d.Z)(function*(){var s;i.sweetAlertService.swalLoading(),i.idVisita=null!==(s=parseInt(i.route.snapshot.queryParams.idVisita))&&void 0!==s?s:0;const o=yield i.profesionalService.RevisarActividad(i.idVisita);i.sweetAlertService.swalClose(),o.success?(i.data=o.data,t&&i.emitDataService.tableData(i.data),i.getButtonTable(),i.getColumnas()):(401===o.code||0===o.code)&&i.authService.sessionExpired()})()}getButtonTable(){var t;this.buttons=[{extend:"excel",title:"Actividades",text:'<i class="far fa-file-excel text-white"></i> Exportar a Excel',className:"btn btn-success text-white",sheetName:`Actividades_${null===(t=this.cliente)||void 0===t?void 0:t.razonSocial}`,exportOptions:{columns:[0,1]}}]}refreshView(){this.revisarActividad(!0),this.read=!0}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.F0),e.Y36(u.uU),e.Y36(p.gz),e.Y36(x.e),e.Y36(g.X),e.Y36(b.T),e.Y36(y),e.Y36(_.b),e.Y36(Z.B))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-actividades"]],decls:4,vars:2,consts:[[1,"container-fluid"],[4,"ngIf"],[1,"card"],[1,"card-header","mt-2"],[1,"row"],[1,"col-xl-6"],[1,"col-xl-6","text-end"],[1,"btn","btn-primary",3,"click"],[1,"c-icon","fas","fa-plus-circle"],[1,"card-body"],["class","col-xl-12 text-center display-4",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"col-xl-12","text-center","display-4"],[1,"table-responsive"],[3,"columnas","data","dom","buttons"],[3,"idVisita","hideView"]],template:function(t,i){1&t&&(e._UZ(0,"app-navbar"),e.TgZ(1,"div",0),e.YNc(2,$,13,2,"ng-container",1),e.YNc(3,L,4,1,"ng-container",1),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",i.read),e.xp6(1),e.Q6J("ngIf",!i.read))},directives:[S,u.O5,A.n,M],styles:[""]}),r})();function X(r,n){1&r&&(e.TgZ(0,"div",6)(1,"h4"),e._uU(2," Sin registros de alertas "),e.qZA()())}function z(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",7)(1,"app-datatable",8),e.NdJ("changeAction",function(s){return e.CHM(t),e.oxw().action(s)}),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(1),e.Tol("table-bordered border fs-6"),e.Q6J("columnas",t.columns)("data",t.data)("dom",t.dom)("buttons",t.buttons)}}let R=(()=>{class r{constructor(t,i,s,o,a,l,f,m){this.router=t,this.datePipe=i,this.route=s,this.authService=o,this.dataSecureService=a,this.sweetAlertService=l,this.profesionalService=f,this.localSecureService=m,this.data=[],this.columns=[],this.dom="",this.buttons=[]}ngOnInit(){this.validaUser()}validaUser(){var t=this;return(0,d.Z)(function*(){t.user=t.localSecureService.getValue("currentUser"),3===t.user.idPerfil?t.checkIdClient():(yield t.sweetAlertService.swalInfo("warning","\xa1Lo sentimos!","No posee los permisos necesarios para ver este \xedtem."))&&t.router.navigate(["/dashboard"])})()}checkIdClient(){const t=this.route.snapshot.queryParams.cliente;this.cliente=t?this.dataSecureService.objectDecrypt(t):null,this.cliente?this.getAlertas():this.router.navigate(["/profesional"])}getColumnas(){this.dom='<"row"<"col-xl-6"B><"col-xl-6"f>><"row"<"col-xl-12"tr>><"row"<"col-xl-4"i><"col-xl-4"l><"col-xl-4"p>>',this.columns=[{title:"Fecha de accidente",data:"fechaAccidente",className:"dt-center",render:t=>this.datePipe.transform(t,"dd-MM-yyyy HH:mm")},{title:"Descripci\xf3n",data:"descripcion",className:"dt-center dt-body-left",orderable:!1},{title:"Estado",data:"idEstado",width:"5%",className:"dt-center",render:(t,i,s)=>`<span class="${3===t?"badge bg-success":1===t?"badge bg-info":"badge bg-danger"}">${s.estado}</span>`},{title:"Crear Caso",className:"dt-center",data:"idAlerta",orderable:!1,defaultContent:"",render:t=>`<button class="btn bg-primary text-white btn-sm" type="submit" title="Actividades" value="${t}">\n                  <i class="c-icon fas fa-pen-to-square pe-none"></i>\n                </button>`}]}action(t){const i=t.value;if(i){const s=this.dataSecureService.encrypt(this.cliente);this.router.navigate(["/profesional/casos"],{queryParams:{cliente:s,idAlerta:i}})}}getAlertas(){var t=this;return(0,d.Z)(function*(){var i;t.sweetAlertService.swalLoading();const s={idProfesional:t.user.idUsuario,idCliente:null===(i=t.cliente)||void 0===i?void 0:i.idCliente},o=yield t.profesionalService.GetAlertas(s);t.sweetAlertService.swalClose(),o.success?(t.data=o.data,t.getButtonTable(),t.getColumnas()):(401===o.code||0===o.code)&&t.authService.sessionExpired()})()}getButtonTable(){var t;this.buttons=[{extend:"excel",title:"Alertas",text:'<i class="far fa-file-excel text-white"></i> Exportar a Excel',className:"btn btn-success text-white",sheetName:`Alertas_${null===(t=this.cliente)||void 0===t?void 0:t.razonSocial}`,exportOptions:{columns:[0,1,2]}}]}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.F0),e.Y36(u.uU),e.Y36(p.gz),e.Y36(x.e),e.Y36(g.X),e.Y36(b.T),e.Y36(y),e.Y36(_.b))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-alertas"]],decls:7,vars:2,consts:[[1,"container-fluid"],[1,"card"],[1,"card-body"],[1,"row"],["class","col-xl-12 text-center display-4",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"col-xl-12","text-center","display-4"],[1,"table-responsive"],[3,"columnas","data","dom","buttons","changeAction"]],template:function(t,i){1&t&&(e._UZ(0,"app-navbar"),e.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3),e.YNc(5,X,3,0,"div",4),e.YNc(6,z,2,6,"div",5),e.qZA()()()()),2&t&&(e.xp6(5),e.Q6J("ngIf",0===i.data.length),e.xp6(1),e.Q6J("ngIf",i.data.length>0))},directives:[S,u.O5,A.n],styles:[""]}),r})();function j(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"i",11),e._uU(2," Por favor, ingrese descripci\xf3n. "),e.qZA())}function K(r,n){if(1&r&&(e.TgZ(0,"div",9),e.YNc(1,j,3,0,"div",10),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.descripcion.errors.required)}}const W=function(r){return{"is-invalid":r}};let ee=(()=>{class r{constructor(t,i,s,o,a,l,f,m,h){this.router=t,this.datePipe=i,this.route=s,this.formBuilder=o,this.authService=a,this.dataSecureService=l,this.sweetAlertService=f,this.profesionalService=m,this.localSecureService=h,this.hideView=new e.vpe,this.isSubmitted=!1,this.fileBase64=""}ngOnInit(){this.checkIdClient()}get f(){return this.formulario.controls}checkIdClient(){const t=this.route.snapshot.queryParams.cliente;this.cliente=t?this.dataSecureService.objectDecrypt(t):null,this.cliente?(this.user=this.localSecureService.getValue("currentUser"),this.initForm()):this.router.navigate(["/profesional"])}initForm(){this.formulario=this.formBuilder.group({descripcion:["",c.kI.required],archivo:[""]})}onSubmit(){this.isSubmitted=!0,!this.formulario.invalid&&this.ingresarAsesoria()}ingresarAsesoria(){var t=this;return(0,d.Z)(function*(){var i;t.sweetAlertService.swalLoading();const s={descripcion:t.f.descripcion.value,fechaIngreso:t.datePipe.transform(Date.now(),"yyyy-MM-dd HH:mm:ss"),documentoB64:null==t.fileBase64?null:t.fileBase64,idProfesional:t.user.idUsuario,idCliente:null===(i=t.cliente)||void 0===i?void 0:i.idCliente},o=yield t.profesionalService.IngresarAsesoria(s);t.sweetAlertService.swalClose(),o.success?(yield t.sweetAlertService.swalInfo("success","\xc9xito","Asesor\xeda ingresada"),t.redirect()):(401===o.code||0===o.code)&&t.authService.sessionExpired()})()}readFile(t){const i=t.target.files[0],s=new FileReader;s.readAsDataURL(i),s.onload=()=>{var o,a;const l=null===(o=s.result)||void 0===o?void 0:o.toString();this.fileBase64=null===(a=null==l?void 0:l.split(","))||void 0===a?void 0:a[1]}}redirect(){this.hideView.emit()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.F0),e.Y36(u.uU),e.Y36(p.gz),e.Y36(c.qu),e.Y36(x.e),e.Y36(g.X),e.Y36(b.T),e.Y36(y),e.Y36(_.b))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-form-asesoria"]],outputs:{hideView:"hideView"},decls:15,vars:5,consts:[[1,"row"],[1,"col-xl-10","mx-auto"],[1,"row",3,"formGroup","ngSubmit"],[1,"col-xl-6","mx-auto","my-4"],["type","text","formControlName","descripcion","cols","30","rows","10",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","file","id","formFile",1,"form-control",3,"change"],[1,"col-xl-12","text-center","mt-5"],["type","submit",1,"btn","btn-primary"],[1,"invalid-feedback"],[4,"ngIf"],[1,"far","fa-times-circle"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(3,"div",3)(4,"h6"),e._uU(5,"Descripci\xf3n"),e.qZA(),e._UZ(6,"textarea",4),e.YNc(7,K,2,1,"div",5),e.qZA(),e.TgZ(8,"div",3)(9,"h6"),e._uU(10,"Seleccionar Archivo"),e.qZA(),e.TgZ(11,"input",6),e.NdJ("change",function(o){return i.readFile(o)}),e.qZA()(),e.TgZ(12,"div",7)(13,"button",8),e._uU(14,"Guardar"),e.qZA()()()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",i.formulario),e.xp6(4),e.Q6J("ngClass",e.VKq(3,W,i.isSubmitted&&i.f.descripcion.errors)),e.xp6(1),e.Q6J("ngIf",i.isSubmitted&&i.f.descripcion.errors))},directives:[c._Y,c.JL,c.sg,c.Fj,c.JJ,c.u,u.mk,u.O5],styles:[""]}),r})();function te(r,n){1&r&&(e.TgZ(0,"div",12)(1,"h4"),e._uU(2," Sin registros de asesor\xeda "),e.qZA()())}function ie(r,n){if(1&r&&(e.TgZ(0,"div",13),e._UZ(1,"app-datatable",14),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.Tol("table-bordered border fs-6"),e.Q6J("columnas",t.columns)("data",t.data)("dom",t.dom)("buttons",t.buttons)}}function se(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2)(2,"div",3)(3,"div",4),e._UZ(4,"div",5),e.TgZ(5,"div",6)(6,"button",7),e.NdJ("click",function(){return e.CHM(t),e.oxw().read=!1}),e._UZ(7,"i",8),e._uU(8,"\xa0\xa0\xa0Crear Asesor\xeda "),e.qZA()()()(),e.TgZ(9,"div",9)(10,"div",4),e.YNc(11,te,3,0,"div",10),e.YNc(12,ie,2,6,"div",11),e.qZA()()(),e.BQk()}if(2&r){const t=e.oxw();e.xp6(11),e.Q6J("ngIf",0===t.data.length),e.xp6(1),e.Q6J("ngIf",t.data.length>0)}}function re(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2)(2,"div",9)(3,"app-form-asesoria",15),e.NdJ("hideView",function(){return e.CHM(t),e.oxw().refreshView()}),e.qZA()()(),e.BQk()}}let oe=(()=>{class r{constructor(t,i,s,o,a,l,f,m,h){this.router=t,this.route=i,this.authService=s,this.dataSecureService=o,this.sweetAlertService=a,this.profesionalService=l,this.localSecureService=f,this.emitDataService=m,this.datePipe=h,this.data=[],this.columns=[],this.dom="",this.buttons=[],this.read=!0}ngOnInit(){this.validaUser()}validaUser(){var t=this;return(0,d.Z)(function*(){t.user=t.localSecureService.getValue("currentUser"),3===t.user.idPerfil?t.checkIdClient():(yield t.sweetAlertService.swalInfo("warning","\xa1Lo sentimos!","No posee los permisos necesarios para ver este \xedtem."))&&t.router.navigate(["/dashboard"])})()}checkIdClient(){const t=this.route.snapshot.queryParams.cliente;this.cliente=t?this.dataSecureService.objectDecrypt(t):null,this.cliente?this.getAsesorias(!1):this.router.navigate(["/profesional"])}getColumnas(){this.dom='<"row"<"col-xl-6"B><"col-xl-6"f>><"row"<"col-xl-12"tr>><"row"<"col-xl-4"i><"col-xl-4"l><"col-xl-4"p>>',this.columns=[{title:"Fecha de ingreso",data:"fechaIngreso",className:"dt-center",render:t=>this.datePipe.transform(t,"dd-MM-yyyy HH:mm")},{title:"Descripci\xf3n",data:"descripcion",className:"dt-center dt-body-left"},{title:"Ver Documento",data:"documentoB64",className:"dt-center",orderable:!1,render:t=>(null==t?void 0:t.length)>0?`<a download=pdfDocument href="data:application/pdf;base64,${t}">\n                        <button class="btn bg-primary text-white btn-sm" type="submit" title="Documento" value="">\n                          <i class="fa-solid fa-file-pdf pe-none"></i> \n                        </button>\n                      </a>`:""},{title:"Estado",data:"estado",className:"dt-center dt-body-left"}]}getAsesorias(t){var i=this;return(0,d.Z)(function*(){var s;i.sweetAlertService.swalLoading();const o={idProfesional:i.user.idUsuario,idCliente:null===(s=i.cliente)||void 0===s?void 0:s.idCliente},a=yield i.profesionalService.GetAsesorias(o);i.sweetAlertService.swalClose(),a.success?(i.data=a.data,t&&i.emitDataService.tableData(i.data),i.getButtonTable(),i.getColumnas()):(401===a.code||0===a.code)&&i.authService.sessionExpired()})()}getButtonTable(){var t;this.buttons=[{extend:"excel",title:"Asesorias",text:'<i class="far fa-file-excel text-white"></i> Exportar a Excel',className:"btn btn-success text-white",sheetName:`Asesorias_${null===(t=this.cliente)||void 0===t?void 0:t.razonSocial}`,exportOptions:{columns:[0,1,2]}}]}refreshView(){this.getAsesorias(!0),this.read=!0}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.F0),e.Y36(p.gz),e.Y36(x.e),e.Y36(g.X),e.Y36(b.T),e.Y36(y),e.Y36(_.b),e.Y36(Z.B),e.Y36(u.uU))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-asesorias"]],decls:4,vars:2,consts:[[1,"container-fluid"],[4,"ngIf"],[1,"card"],[1,"card-header","mt-2"],[1,"row"],[1,"col-xl-6"],[1,"col-xl-6","text-end"],[1,"btn","btn-primary",3,"click"],[1,"c-icon","fas","fa-plus-circle"],[1,"card-body"],["class","col-xl-12 text-center display-4",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"col-xl-12","text-center","display-4"],[1,"table-responsive"],[3,"columnas","data","dom","buttons"],[3,"hideView"]],template:function(t,i){1&t&&(e._UZ(0,"app-navbar"),e.TgZ(1,"div",0),e.YNc(2,se,13,2,"ng-container",1),e.YNc(3,re,4,0,"ng-container",1),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",i.read),e.xp6(1),e.Q6J("ngIf",!i.read))},directives:[S,u.O5,A.n,ee],styles:[""]}),r})();function ne(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"i",14),e._uU(2," Por favor, selecciona una fecha. "),e.qZA())}function ae(r,n){if(1&r&&(e.TgZ(0,"div",12),e.YNc(1,ne,3,0,"div",13),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.fecha.errors.required)}}function ce(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"i",14),e._uU(2," Por favor, selecciona una hora. "),e.qZA())}function le(r,n){if(1&r&&(e.TgZ(0,"div",12),e.YNc(1,ce,3,0,"div",13),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.hora.errors.required)}}function de(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"i",14),e._uU(2," Por favor, ingresa un n\xfamero de asistentes. "),e.qZA())}function ue(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"i",14),e._uU(2," La cantidad de asistentes debe ser mayor a 0. "),e.qZA())}function pe(r,n){if(1&r&&(e.TgZ(0,"div",12),e.YNc(1,de,3,0,"div",13),e.YNc(2,ue,3,0,"div",13),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.asistentes.errors.required),e.xp6(1),e.Q6J("ngIf",t.f.asistentes.errors.asistInvalid)}}function fe(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"i",14),e._uU(2," Por favor, ingrese descripci\xf3n. "),e.qZA())}function me(r,n){if(1&r&&(e.TgZ(0,"div",12),e.YNc(1,fe,3,0,"div",13),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.descripcion.errors.required)}}const w=function(r){return{"is-invalid":r}};let he=(()=>{class r{constructor(t,i,s,o,a,l,f,m,h){this.router=t,this.datePipe=i,this.route=s,this.formBuilder=o,this.authService=a,this.dataSecureService=l,this.sweetAlertService=f,this.profesionalService=m,this.localSecureService=h,this.hideView=new e.vpe,this.isSubmitted=!1}ngOnInit(){this.checkIdClient()}get f(){return this.formulario.controls}checkIdClient(){const t=this.route.snapshot.queryParams.cliente;this.cliente=t?this.dataSecureService.objectDecrypt(t):null,this.cliente?(this.user=this.localSecureService.getValue("currentUser"),this.initForm()):this.router.navigate(["/profesional"])}initForm(){this.formulario=this.formBuilder.group({fecha:["",c.kI.required],hora:["",c.kI.required],asistentes:["",[c.kI.required,this.validaAsist()]],descripcion:["",c.kI.required]}),this.setForm()}setForm(){const t=new Date,i=t.setDate(t.getDate()+1);this.minDate=this.datePipe.transform(i,"yyyy-MM-dd"),this.formulario.patchValue({fecha:this.datePipe.transform(i,"yyyy-MM-dd")})}onlyNro(){this.formulario.patchValue({asistentes:this.f.asistentes.value.replace(/[^0-9]*/g,"")})}validaAsist(){return t=>{const i=t.value;return i?i>0?null:{asistInvalid:!0}:null}}onSubmit(){this.isSubmitted=!0,!this.formulario.invalid&&this.crearCapacitacion()}crearCapacitacion(){var t=this;return(0,d.Z)(function*(){var i,s;t.sweetAlertService.swalLoading();const o={fechaCapacitacion:`${t.f.fecha.value} ${t.f.hora.value}:00`,descripcion:t.f.descripcion.value,asistentes:parseInt(null!==(i=t.f.asistentes.value)&&void 0!==i?i:0,0),idProfesional:t.user.idUsuario,idCliente:null===(s=t.cliente)||void 0===s?void 0:s.idCliente},a=yield t.profesionalService.CrearCapacitacion(o);t.sweetAlertService.swalClose(),a.success?(yield t.sweetAlertService.swalInfo("success","\xc9xito","Capacitaci\xf3n ingresada"),t.redirect()):(401===a.code||0===a.code)&&t.authService.sessionExpired()})()}redirect(){this.hideView.emit()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.F0),e.Y36(u.uU),e.Y36(p.gz),e.Y36(c.qu),e.Y36(x.e),e.Y36(g.X),e.Y36(b.T),e.Y36(y),e.Y36(_.b))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-form-capacitacion"]],outputs:{hideView:"hideView"},decls:26,vars:18,consts:[[1,"row"],[1,"col-xl-10","mx-auto"],[1,"row",3,"formGroup","ngSubmit"],[1,"col-xl-4","mx-auto","my-4"],["type","date","placeholder","DD/MM/AAAA","formControlName","fecha",1,"form-control","text-center",3,"min","ngClass"],["class","invalid-feedback",4,"ngIf"],["type","time","placeholder","HH:mm","formControlName","hora",1,"form-control","text-center",3,"min","ngClass"],["formControlName","asistentes","maxlength","12",1,"form-control",3,"ngClass","keyup"],[1,"col-xl-6","mx-auto","my-4"],["type","text","formControlName","descripcion","cols","30","rows","10",1,"form-control",3,"ngClass"],[1,"col-xl-12","text-center","mt-5"],["type","submit",1,"btn","btn-primary"],[1,"invalid-feedback"],[4,"ngIf"],[1,"far","fa-times-circle"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(3,"div",3)(4,"h6"),e._uU(5,"Fecha Inicio"),e.qZA(),e._UZ(6,"input",4),e.YNc(7,ae,2,1,"div",5),e.qZA(),e.TgZ(8,"div",3)(9,"h6"),e._uU(10,"Hora Inicio"),e.qZA(),e._UZ(11,"input",6),e.YNc(12,le,2,1,"div",5),e.qZA(),e.TgZ(13,"div",3)(14,"h6"),e._uU(15,"Asistentes"),e.qZA(),e.TgZ(16,"input",7),e.NdJ("keyup",function(){return i.onlyNro()}),e.qZA(),e.YNc(17,pe,3,2,"div",5),e.qZA(),e.TgZ(18,"div",8)(19,"h6"),e._uU(20,"Descripci\xf3n"),e.qZA(),e._UZ(21,"textarea",9),e.YNc(22,me,2,1,"div",5),e.qZA(),e.TgZ(23,"div",10)(24,"button",11),e._uU(25,"Guardar"),e.qZA()()()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",i.formulario),e.xp6(4),e.Q6J("min",i.minDate)("ngClass",e.VKq(10,w,i.isSubmitted&&i.f.fecha.invalid)),e.xp6(1),e.Q6J("ngIf",i.isSubmitted&&i.f.fecha.errors),e.xp6(4),e.Q6J("ngClass",e.VKq(12,w,i.isSubmitted&&i.f.hora.invalid)),e.xp6(1),e.Q6J("ngIf",i.isSubmitted&&i.f.hora.errors),e.xp6(4),e.Q6J("ngClass",e.VKq(14,w,i.isSubmitted&&i.f.asistentes.errors)),e.xp6(1),e.Q6J("ngIf",i.isSubmitted&&i.f.asistentes.errors),e.xp6(4),e.Q6J("ngClass",e.VKq(16,w,i.isSubmitted&&i.f.descripcion.errors)),e.xp6(1),e.Q6J("ngIf",i.isSubmitted&&i.f.descripcion.errors))},directives:[c._Y,c.JL,c.sg,c.Fj,c.JJ,c.u,u.mk,u.O5,c.nD],styles:[""]}),r})();function ve(r,n){1&r&&(e.TgZ(0,"div",12)(1,"h4"),e._uU(2," Sin registros de capacitaci\xf3n "),e.qZA()())}function _e(r,n){if(1&r&&(e.TgZ(0,"div",13),e._UZ(1,"app-datatable",14),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.Tol("table-bordered border fs-6"),e.Q6J("columnas",t.columns)("data",t.data)("dom",t.dom)("buttons",t.buttons)}}function ge(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2)(2,"div",3)(3,"div",4),e._UZ(4,"div",5),e.TgZ(5,"div",6)(6,"button",7),e.NdJ("click",function(){return e.CHM(t),e.oxw().read=!1}),e._UZ(7,"i",8),e._uU(8,"\xa0\xa0\xa0Crear Capacitaci\xf3n "),e.qZA()()()(),e.TgZ(9,"div",9)(10,"div",4),e.YNc(11,ve,3,0,"div",10),e.YNc(12,_e,2,6,"div",11),e.qZA()()(),e.BQk()}if(2&r){const t=e.oxw();e.xp6(11),e.Q6J("ngIf",0===t.data.length),e.xp6(1),e.Q6J("ngIf",t.data.length>0)}}function Ce(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2)(2,"div",9)(3,"app-form-capacitacion",15),e.NdJ("hideView",function(){return e.CHM(t),e.oxw().refreshView()}),e.qZA()()(),e.BQk()}}let xe=(()=>{class r{constructor(t,i,s,o,a,l,f,m,h){this.router=t,this.datePipe=i,this.route=s,this.authService=o,this.dataSecureService=a,this.sweetAlertService=l,this.profesionalService=f,this.localSecureService=m,this.emitDataService=h,this.data=[],this.columns=[],this.dom="",this.buttons=[],this.read=!0}ngOnInit(){this.validaUser()}validaUser(){var t=this;return(0,d.Z)(function*(){t.user=t.localSecureService.getValue("currentUser"),3===t.user.idPerfil?t.checkIdClient():(yield t.sweetAlertService.swalInfo("warning","\xa1Lo sentimos!","No posee los permisos necesarios para ver este \xedtem."))&&t.router.navigate(["/dashboard"])})()}checkIdClient(){const t=this.route.snapshot.queryParams.cliente;this.cliente=t?this.dataSecureService.objectDecrypt(t):null,this.cliente?this.getCapacitaciones(!1):this.router.navigate(["/profesional"])}getColumnas(){this.dom='<"row"<"col-xl-6"B><"col-xl-6"f>><"row"<"col-xl-12"tr>><"row"<"col-xl-4"i><"col-xl-4"l><"col-xl-4"p>>',this.columns=[{title:"Fecha de capacitaci\xf3n",data:"fechaCapacitacion",className:"dt-center",render:t=>this.datePipe.transform(t,"dd-MM-yyyy HH:mm")},{title:"Descripci\xf3n",data:"descripcion",className:"dt-center dt-body-left",orderable:!1},{title:"Asistentes",data:"asistentes",className:"dt-center dt-body-left"},{title:"Estado",data:"estado",className:"dt-center dt-body-left"}]}getCapacitaciones(t){var i=this;return(0,d.Z)(function*(){var s;i.sweetAlertService.swalLoading();const o={idProfesional:i.user.idUsuario,idCliente:null===(s=i.cliente)||void 0===s?void 0:s.idCliente},a=yield i.profesionalService.GetCapacitaciones(o);i.sweetAlertService.swalClose(),a.success?(i.data=a.data,t&&i.emitDataService.tableData(i.data),i.getButtonTable(),i.getColumnas()):(401===a.code||0===a.code)&&i.authService.sessionExpired()})()}getButtonTable(){var t;this.buttons=[{extend:"excel",title:"Capacitaciones",text:'<i class="far fa-file-excel text-white"></i> Exportar a Excel',className:"btn btn-success text-white",sheetName:`Capacitaciones_${null===(t=this.cliente)||void 0===t?void 0:t.razonSocial}`}]}refreshView(){this.getCapacitaciones(!0),this.read=!0}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.F0),e.Y36(u.uU),e.Y36(p.gz),e.Y36(x.e),e.Y36(g.X),e.Y36(b.T),e.Y36(y),e.Y36(_.b),e.Y36(Z.B))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-capacitaciones"]],decls:4,vars:2,consts:[[1,"container-fluid"],[4,"ngIf"],[1,"card"],[1,"card-header","mt-2"],[1,"row"],[1,"col-xl-6"],[1,"col-xl-6","text-end"],[1,"btn","btn-primary",3,"click"],[1,"c-icon","fas","fa-plus-circle"],[1,"card-body"],["class","col-xl-12 text-center display-4",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"col-xl-12","text-center","display-4"],[1,"table-responsive"],[3,"columnas","data","dom","buttons"],[3,"hideView"]],template:function(t,i){1&t&&(e._UZ(0,"app-navbar"),e.TgZ(1,"div",0),e.YNc(2,ge,13,2,"ng-container",1),e.YNc(3,Ce,4,0,"ng-container",1),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",i.read),e.xp6(1),e.Q6J("ngIf",!i.read))},directives:[S,u.O5,A.n,he],styles:[""]}),r})();function be(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"i",13),e._uU(2," Por favor, selecciona una fecha. "),e.qZA())}function ye(r,n){if(1&r&&(e.TgZ(0,"div",11),e.YNc(1,be,3,0,"div",12),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.fecha.errors.required)}}function Se(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"i",13),e._uU(2," Por favor, ingrese descripci\xf3n. "),e.qZA())}function Ae(r,n){if(1&r&&(e.TgZ(0,"div",11),e.YNc(1,Se,3,0,"div",12),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.descripcion.errors.required)}}const q=function(r){return{"is-invalid":r}};let Ze=(()=>{class r{constructor(t,i,s,o,a,l,f,m,h){this.router=t,this.datePipe=i,this.route=s,this.formBuilder=o,this.authService=a,this.dataSecureService=l,this.sweetAlertService=f,this.profesionalService=m,this.localSecureService=h,this.isSubmitted=!1,this.fileBase64=""}ngOnInit(){this.checkIdClient()}get f(){return this.formulario.controls}checkIdClient(){const t=this.route.snapshot.queryParams.cliente;this.cliente=t?this.dataSecureService.objectDecrypt(t):null,this.cliente?(this.user=this.localSecureService.getValue("currentUser"),this.initForm()):this.router.navigate(["/profesional"])}initForm(){this.formulario=this.formBuilder.group({fecha:["",c.kI.required],descripcion:["",c.kI.required],archivo:[""]}),this.setForm()}setForm(){const t=new Date,i=t.setDate(t.getDate()+1);this.minDate=this.datePipe.transform(i,"yyyy-MM-dd"),this.formulario.patchValue({fecha:this.datePipe.transform(i,"yyyy-MM-dd")})}onSubmit(){this.isSubmitted=!0,!this.formulario.invalid&&this.crearCasoAsesoria()}crearCasoAsesoria(){var t=this;return(0,d.Z)(function*(){var i;t.sweetAlertService.swalLoading();const s=null!==(i=parseInt(t.route.snapshot.queryParams.idAlerta))&&void 0!==i?i:0,o={descripcion:t.f.descripcion.value,fechaIngreso:t.f.fecha.value,documentoB64:null==t.fileBase64?null:t.fileBase64,idAlerta:s},a=yield t.profesionalService.CrearCasoAsesoria(o);if(t.sweetAlertService.swalClose(),a.success){yield t.sweetAlertService.swalInfo("success","\xc9xito","Caso creado");const l=t.dataSecureService.encrypt(t.cliente);t.router.navigate(["/profesional/alertas"],{queryParams:{cliente:l}})}else(401===a.code||0===a.code)&&t.authService.sessionExpired()})()}readFile(t){const i=t.target.files[0],s=new FileReader;s.readAsDataURL(i),s.onload=()=>{var o,a;const l=null===(o=s.result)||void 0===o?void 0:o.toString();this.fileBase64=null===(a=null==l?void 0:l.split(","))||void 0===a?void 0:a[1]}}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.F0),e.Y36(u.uU),e.Y36(p.gz),e.Y36(c.qu),e.Y36(x.e),e.Y36(g.X),e.Y36(b.T),e.Y36(y),e.Y36(_.b))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-form-casos"]],decls:20,vars:10,consts:[[1,"row"],[1,"col-xl-10","mx-auto"],[1,"row",3,"formGroup","ngSubmit"],[1,"col-xl-4","mx-auto","my-4"],["type","date","placeholder","DD/MM/AAAA","formControlName","fecha",1,"form-control","text-center",3,"min","ngClass"],["class","invalid-feedback",4,"ngIf"],[1,"col-xl-6","mx-auto","my-4"],["type","text","formControlName","descripcion","cols","30","rows","10",1,"form-control",3,"ngClass"],["type","file","id","formFile",1,"form-control",3,"change"],[1,"col-xl-12","text-center","mt-5"],["type","submit",1,"btn","btn-primary"],[1,"invalid-feedback"],[4,"ngIf"],[1,"far","fa-times-circle"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(3,"div",3)(4,"h6"),e._uU(5,"Fecha Visita"),e.qZA(),e._UZ(6,"input",4),e.YNc(7,ye,2,1,"div",5),e.qZA(),e.TgZ(8,"div",6)(9,"h6"),e._uU(10,"Descripci\xf3n"),e.qZA(),e._UZ(11,"textarea",7),e.YNc(12,Ae,2,1,"div",5),e.qZA(),e.TgZ(13,"div",6)(14,"h6"),e._uU(15,"Seleccionar Archivo"),e.qZA(),e.TgZ(16,"input",8),e.NdJ("change",function(o){return i.readFile(o)}),e.qZA()(),e.TgZ(17,"div",9)(18,"button",10),e._uU(19,"Guardar"),e.qZA()()()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",i.formulario),e.xp6(4),e.Q6J("min",i.minDate)("ngClass",e.VKq(6,q,i.isSubmitted&&i.f.fecha.invalid)),e.xp6(1),e.Q6J("ngIf",i.isSubmitted&&i.f.fecha.errors),e.xp6(4),e.Q6J("ngClass",e.VKq(8,q,i.isSubmitted&&i.f.descripcion.errors)),e.xp6(1),e.Q6J("ngIf",i.isSubmitted&&i.f.descripcion.errors))},directives:[c._Y,c.JL,c.sg,c.Fj,c.JJ,c.u,u.mk,u.O5],styles:[""]}),r})(),we=(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-casos"]],decls:5,vars:0,consts:[[1,"container-fluid"],[1,"card"],[1,"card-body"]],template:function(t,i){1&t&&(e._UZ(0,"app-navbar"),e.TgZ(1,"div",0)(2,"div",1)(3,"div",2),e._UZ(4,"app-form-casos"),e.qZA()()())},directives:[S,Ze],styles:[""]}),r})();function Te(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"i",12),e._uU(2," Por favor, ingrese descripci\xf3n. "),e.qZA())}function Ne(r,n){if(1&r&&(e.TgZ(0,"div",10),e.YNc(1,Te,3,0,"div",11),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.descripcion.errors.required)}}function Ie(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"i",12),e._uU(2," Por favor, seleccione estado. "),e.qZA())}function Fe(r,n){if(1&r&&(e.TgZ(0,"div",10),e.YNc(1,Ie,3,0,"div",11),e.qZA()),2&r){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.f.estado.errors.required)}}const Y=function(r){return{"is-invalid":r}};function qe(r,n){if(1&r&&(e.TgZ(0,"div",3)(1,"h6"),e._uU(2,"Estado"),e.qZA(),e.TgZ(3,"select",13)(4,"option",14),e._uU(5,"Seleccione..."),e.qZA(),e.TgZ(6,"option",15),e._uU(7,"Aprobado"),e.qZA(),e.TgZ(8,"option",16),e._uU(9,"Rechazado"),e.qZA()(),e.YNc(10,Fe,2,1,"div",5),e.qZA()),2&r){const t=e.oxw();e.xp6(3),e.Q6J("ngClass",e.VKq(2,Y,t.isSubmitted&&t.f.estado.errors)),e.xp6(7),e.Q6J("ngIf",t.isSubmitted&&t.f.estado.errors)}}let Ye=(()=>{class r{constructor(t,i,s,o,a,l,f,m){this.router=t,this.route=i,this.formBuilder=s,this.authService=o,this.dataSecureService=a,this.sweetAlertService=l,this.profesionalService=f,this.localSecureService=m,this.hideView=new e.vpe,this.isSubmitted=!1,this.fileBase64=""}ngOnInit(){this.checkIdClient()}get f(){return this.formulario.controls}checkIdClient(){const t=this.route.snapshot.queryParams.cliente;this.cliente=t?this.dataSecureService.objectDecrypt(t):null,this.cliente?(this.user=this.localSecureService.getValue("currentUser"),this.initForm(),this.checklist&&this.setForm()):this.router.navigate(["/profesional"])}initForm(){this.formulario=this.formBuilder.group({descripcion:["",c.kI.required],archivo:[""],estado:[""]})}setForm(){this.formulario.patchValue({descripcion:this.checklist.descripcion,archivo:this.checklist.archivo}),this.f.estado.setValidators([c.kI.required])}onSubmit(){this.isSubmitted=!0,!this.formulario.invalid&&(this.checklist?this.responderChecklist():this.crearChecklist())}crearChecklist(){var t=this;return(0,d.Z)(function*(){var i;t.sweetAlertService.swalLoading();const s={descripcion:t.f.descripcion.value,documentoB64:null==t.fileBase64?null:t.fileBase64,idProfesional:t.user.idUsuario,idCliente:null===(i=t.cliente)||void 0===i?void 0:i.idCliente},o=yield t.profesionalService.CrearChecklist(s);t.sweetAlertService.swalClose(),o.success?(yield t.sweetAlertService.swalInfo("success","\xc9xito","Checklist ingresada"),t.redirect()):(401===o.code||0===o.code)&&t.authService.sessionExpired()})()}responderChecklist(){var t=this;return(0,d.Z)(function*(){var i;t.sweetAlertService.swalLoading();const s={idChecklist:null===(i=t.checklist)||void 0===i?void 0:i.idChecklist,descripcion:t.f.descripcion.value,documentoB64:null==t.fileBase64?null:t.fileBase64,idEstado:parseInt(t.f.estado.value,0)},o=yield t.profesionalService.ResponderChecklist(s);t.sweetAlertService.swalClose(),o.success?(yield t.sweetAlertService.swalInfo("success","\xc9xito","Checklist respondida"),t.redirect()):(401===o.code||0===o.code)&&t.authService.sessionExpired()})()}readFile(t){const i=t.target.files[0],s=new FileReader;s.readAsDataURL(i),s.onload=()=>{var o,a;const l=null===(o=s.result)||void 0===o?void 0:o.toString();this.fileBase64=null===(a=null==l?void 0:l.split(","))||void 0===a?void 0:a[1]}}redirect(){this.hideView.emit()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.F0),e.Y36(p.gz),e.Y36(c.qu),e.Y36(x.e),e.Y36(g.X),e.Y36(b.T),e.Y36(y),e.Y36(_.b))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-form-checklist"]],inputs:{checklist:"checklist"},outputs:{hideView:"hideView"},decls:16,vars:6,consts:[[1,"row"],[1,"col-xl-10","mx-auto"],[1,"row",3,"formGroup","ngSubmit"],[1,"col-xl-6","mx-auto","my-4"],["type","text","formControlName","descripcion","cols","30","rows","10",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","file","id","formFile",1,"form-control",3,"change"],["class","col-xl-6 mx-auto my-4",4,"ngIf"],[1,"col-xl-12","text-center","mt-5"],["type","submit",1,"btn","btn-primary"],[1,"invalid-feedback"],[4,"ngIf"],[1,"far","fa-times-circle"],["formControlName","estado",1,"form-select",3,"ngClass"],["value","","disabled",""],["value","2"],["value","3"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(3,"div",3)(4,"h6"),e._uU(5,"Descripci\xf3n"),e.qZA(),e._UZ(6,"textarea",4),e.YNc(7,Ne,2,1,"div",5),e.qZA(),e.TgZ(8,"div",3)(9,"h6"),e._uU(10,"Seleccionar Archivo"),e.qZA(),e.TgZ(11,"input",6),e.NdJ("change",function(o){return i.readFile(o)}),e.qZA()(),e.YNc(12,qe,11,4,"div",7),e.TgZ(13,"div",8)(14,"button",9),e._uU(15,"Guardar"),e.qZA()()()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",i.formulario),e.xp6(4),e.Q6J("ngClass",e.VKq(4,Y,i.isSubmitted&&i.f.descripcion.errors)),e.xp6(1),e.Q6J("ngIf",i.isSubmitted&&i.f.descripcion.errors),e.xp6(5),e.Q6J("ngIf",i.checklist))},directives:[c._Y,c.JL,c.sg,c.Fj,c.JJ,c.u,u.mk,u.O5,c.EJ,c.YN,c.Kr],styles:[""]}),r})();function ke(r,n){1&r&&(e.TgZ(0,"div",12)(1,"h4"),e._uU(2," Sin registros de checklist "),e.qZA()())}function Ue(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",13)(1,"app-datatable",14),e.NdJ("changeAction",function(s){return e.CHM(t),e.oxw(2).action(s)}),e.qZA()()}if(2&r){const t=e.oxw(2);e.xp6(1),e.Tol("table-bordered border fs-6"),e.Q6J("columnas",t.columns)("data",t.data)("dom",t.dom)("buttons",t.buttons)}}function Ve(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2)(2,"div",3)(3,"div",4),e._UZ(4,"div",5),e.TgZ(5,"div",6)(6,"button",7),e.NdJ("click",function(){return e.CHM(t),e.oxw().crearChecklist()}),e._UZ(7,"i",8),e._uU(8,"\xa0\xa0\xa0Crear Checklist "),e.qZA()()()(),e.TgZ(9,"div",9)(10,"div",4),e.YNc(11,ke,3,0,"div",10),e.YNc(12,Ue,2,6,"div",11),e.qZA()()(),e.BQk()}if(2&r){const t=e.oxw();e.xp6(11),e.Q6J("ngIf",0===t.data.length),e.xp6(1),e.Q6J("ngIf",t.data.length>0)}}function Je(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2)(2,"div",9)(3,"app-form-checklist",15),e.NdJ("hideView",function(){return e.CHM(t),e.oxw().refreshView()}),e.qZA()()(),e.BQk()}if(2&r){const t=e.oxw();e.xp6(3),e.Q6J("checklist",t.checklist)}}let Pe=(()=>{class r{constructor(t,i,s,o,a,l,f,m,h){this.router=t,this.datePipe=i,this.route=s,this.authService=o,this.dataSecureService=a,this.sweetAlertService=l,this.profesionalService=f,this.localSecureService=m,this.emitDataService=h,this.data=[],this.columns=[],this.dom="",this.buttons=[],this.read=!0}ngOnInit(){this.validaUser()}validaUser(){var t=this;return(0,d.Z)(function*(){t.user=t.localSecureService.getValue("currentUser"),3===t.user.idPerfil?t.checkIdClient():(yield t.sweetAlertService.swalInfo("warning","\xa1Lo sentimos!","No posee los permisos necesarios para ver este \xedtem."))&&t.router.navigate(["/dashboard"])})()}checkIdClient(){const t=this.route.snapshot.queryParams.cliente;this.cliente=t?this.dataSecureService.objectDecrypt(t):null,this.cliente?this.getChecklists(!1):this.router.navigate(["/profesional"])}getColumnas(){this.dom='<"row"<"col-xl-6"B><"col-xl-6"f>><"row"<"col-xl-12"tr>><"row"<"col-xl-4"i><"col-xl-4"l><"col-xl-4"p>>',this.columns=[{title:"Fecha de ingreso",data:"fechaIngreso",className:"dt-center",render:t=>this.datePipe.transform(t,"dd-MM-yyyy HH:mm")},{title:"Descripci\xf3n",data:"descripcion",className:"dt-center dt-body-left",orderable:!1},{title:"Ver Documento",data:"documentoB64",className:"dt-center",orderable:!1,render:t=>(null==t?void 0:t.length)>0?`<a download=pdfDocument href="data:application/pdf;base64,${t}">\n                        <button class="btn bg-primary text-white btn-sm" type="submit" title="Documento" value="">\n                          <i class="fa-solid fa-file-pdf pe-none"></i> \n                        </button>\n                      </a>`:""},{title:"Estado",data:"idEstado",width:"5%",className:"dt-center",render:(t,i,s)=>`<span class="${2===t?"badge bg-success":1===t?"badge bg-info":"badge bg-danger"}">${s.estado}</span>`},{title:"Responder",className:"dt-center",orderable:!1,defaultContent:"",render:(t,i,s)=>`<button class="btn bg-primary text-white btn-sm" type="submit" title="Responder" value="${JSON.stringify(s).replace(/"/g,"'")}">\n                  <i class="c-icon fas fa-reply pe-none"></i>\n                </button>`}]}action(t){var i;const s=t.value?JSON.parse(null===(i=t.value)||void 0===i?void 0:i.replace(/'/g,'"')):null;s&&(this.read=!1,this.checklist=s)}getChecklists(t){var i=this;return(0,d.Z)(function*(){var s;i.sweetAlertService.swalLoading();const o={idProfesional:i.user.idUsuario,idCliente:null===(s=i.cliente)||void 0===s?void 0:s.idCliente},a=yield i.profesionalService.GetChecklists(o);i.sweetAlertService.swalClose(),a.success?(i.data=a.data,t&&i.emitDataService.tableData(i.data),i.getButtonTable(),i.getColumnas()):(401===a.code||0===a.code)&&i.authService.sessionExpired()})()}getButtonTable(){var t;this.buttons=[{extend:"excel",title:"Checklist",text:'<i class="far fa-file-excel text-white"></i> Exportar a Excel',className:"btn btn-success text-white",sheetName:`Checklist_${null===(t=this.cliente)||void 0===t?void 0:t.razonSocial}`,exportOptions:{columns:[0,1,2,3]}}]}crearChecklist(){this.read=!1,this.checklist=null}refreshView(){this.getChecklists(!0),this.read=!0}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.F0),e.Y36(u.uU),e.Y36(p.gz),e.Y36(x.e),e.Y36(g.X),e.Y36(b.T),e.Y36(y),e.Y36(_.b),e.Y36(Z.B))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-checklist"]],decls:4,vars:2,consts:[[1,"container-fluid"],[4,"ngIf"],[1,"card"],[1,"card-header","mt-2"],[1,"row"],[1,"col-xl-6"],[1,"col-xl-6","text-end"],[1,"btn","btn-primary",3,"click"],[1,"c-icon","fas","fa-plus-circle"],[1,"card-body"],["class","col-xl-12 text-center display-4",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"col-xl-12","text-center","display-4"],[1,"table-responsive"],[3,"columnas","data","dom","buttons","changeAction"],[3,"checklist","hideView"]],template:function(t,i){1&t&&(e._UZ(0,"app-navbar"),e.TgZ(1,"div",0),e.YNc(2,Ve,13,2,"ng-container",1),e.YNc(3,Je,4,1,"ng-container",1),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",i.read),e.xp6(1),e.Q6J("ngIf",!i.read))},directives:[S,u.O5,A.n,Ye],styles:[""]}),r})();function De(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"i",13),e._uU(2," Por favor, selecciona una fecha. "),e.qZA())}function Qe(r,n){if(1&r&&(e.TgZ(0,"div",11),e.YNc(1,De,3,0,"div",12),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.fecha.errors.required)}}function Be(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"i",13),e._uU(2," Por favor, selecciona una hora. "),e.qZA())}function Ee(r,n){if(1&r&&(e.TgZ(0,"div",11),e.YNc(1,Be,3,0,"div",12),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.hora.errors.required)}}function Me(r,n){1&r&&(e.TgZ(0,"div"),e._UZ(1,"i",13),e._uU(2," Por favor, ingrese descripci\xf3n. "),e.qZA())}function Oe(r,n){if(1&r&&(e.TgZ(0,"div",11),e.YNc(1,Me,3,0,"div",12),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.f.descripcion.errors.required)}}const T=function(r){return{"is-invalid":r}};let He=(()=>{class r{constructor(t,i,s,o,a,l,f,m,h){this.router=t,this.datePipe=i,this.route=s,this.formBuilder=o,this.authService=a,this.dataSecureService=l,this.sweetAlertService=f,this.profesionalService=m,this.localSecureService=h,this.hideView=new e.vpe,this.isSubmitted=!1}ngOnInit(){this.checkIdClient()}get f(){return this.formulario.controls}checkIdClient(){const t=this.route.snapshot.queryParams.cliente;this.cliente=t?this.dataSecureService.objectDecrypt(t):null,this.cliente?(this.user=this.localSecureService.getValue("currentUser"),this.initForm()):this.router.navigate(["/profesional"])}initForm(){this.formulario=this.formBuilder.group({fecha:["",c.kI.required],hora:["",c.kI.required],descripcion:["",c.kI.required]}),this.setForm()}setForm(){const t=new Date,i=t.setDate(t.getDate()+1);this.minDate=this.datePipe.transform(i,"yyyy-MM-dd"),this.formulario.patchValue({fecha:this.datePipe.transform(i,"yyyy-MM-dd")})}onSubmit(){this.isSubmitted=!0,!this.formulario.invalid&&this.crearVisita()}crearVisita(){var t=this;return(0,d.Z)(function*(){var i;t.sweetAlertService.swalLoading();const s={fechaVisita:`${t.f.fecha.value} ${t.f.hora.value}:00`,descripcion:t.f.descripcion.value,idProfesional:t.user.idUsuario,idCliente:null===(i=t.cliente)||void 0===i?void 0:i.idCliente},o=yield t.profesionalService.CrearVisita(s);t.sweetAlertService.swalClose(),o.success?(yield t.sweetAlertService.swalInfo("success","\xc9xito","Visita agendada"),t.redirect()):(401===o.code||0===o.code)&&t.authService.sessionExpired()})()}redirect(){this.hideView.emit()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.F0),e.Y36(u.uU),e.Y36(p.gz),e.Y36(c.qu),e.Y36(x.e),e.Y36(g.X),e.Y36(b.T),e.Y36(y),e.Y36(_.b))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-form-visita"]],outputs:{hideView:"hideView"},decls:21,vars:14,consts:[[1,"row"],[1,"col-xl-10","mx-auto"],[1,"row",3,"formGroup","ngSubmit"],[1,"col-xl-4","mx-auto","my-4"],["type","date","placeholder","DD/MM/AAAA","formControlName","fecha",1,"form-control","text-center",3,"min","ngClass"],["class","invalid-feedback",4,"ngIf"],["type","time","placeholder","HH:mm","formControlName","hora",1,"form-control","text-center",3,"ngClass"],[1,"col-xl-6","mx-auto","my-4"],["type","text","formControlName","descripcion","cols","30","rows","10",1,"form-control",3,"ngClass"],[1,"col-xl-12","text-center","mt-5"],["type","submit",1,"btn","btn-primary"],[1,"invalid-feedback"],[4,"ngIf"],[1,"far","fa-times-circle"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"form",2),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(3,"div",3)(4,"h6"),e._uU(5,"Fecha Visita"),e.qZA(),e._UZ(6,"input",4),e.YNc(7,Qe,2,1,"div",5),e.qZA(),e.TgZ(8,"div",3)(9,"h6"),e._uU(10,"Hora Visita"),e.qZA(),e._UZ(11,"input",6),e.YNc(12,Ee,2,1,"div",5),e.qZA(),e.TgZ(13,"div",7)(14,"h6"),e._uU(15,"Descripci\xf3n"),e.qZA(),e._UZ(16,"textarea",8),e.YNc(17,Oe,2,1,"div",5),e.qZA(),e.TgZ(18,"div",9)(19,"button",10),e._uU(20,"Guardar"),e.qZA()()()()()),2&t&&(e.xp6(2),e.Q6J("formGroup",i.formulario),e.xp6(4),e.Q6J("min",i.minDate)("ngClass",e.VKq(8,T,i.isSubmitted&&i.f.fecha.invalid)),e.xp6(1),e.Q6J("ngIf",i.isSubmitted&&i.f.fecha.errors),e.xp6(4),e.Q6J("ngClass",e.VKq(10,T,i.isSubmitted&&i.f.hora.invalid)),e.xp6(1),e.Q6J("ngIf",i.isSubmitted&&i.f.hora.errors),e.xp6(4),e.Q6J("ngClass",e.VKq(12,T,i.isSubmitted&&i.f.descripcion.errors)),e.xp6(1),e.Q6J("ngIf",i.isSubmitted&&i.f.descripcion.errors))},directives:[c._Y,c.JL,c.sg,c.Fj,c.JJ,c.u,u.mk,u.O5],styles:[""]}),r})();function $e(r,n){1&r&&(e.TgZ(0,"div",12)(1,"h4"),e._uU(2," Sin registros de visitas "),e.qZA()())}function Le(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",13)(1,"app-datatable",14),e.NdJ("changeAction",function(s){return e.CHM(t),e.oxw(2).action(s)}),e.qZA()()}if(2&r){const t=e.oxw(2);e.xp6(1),e.Tol("table-bordered border fs-6"),e.Q6J("columnas",t.columns)("data",t.data)("dom",t.dom)("buttons",t.buttons)}}function Ge(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2)(2,"div",3)(3,"div",4),e._UZ(4,"div",5),e.TgZ(5,"div",6)(6,"button",7),e.NdJ("click",function(){return e.CHM(t),e.oxw().read=!1}),e._UZ(7,"i",8),e._uU(8,"\xa0\xa0\xa0Crear Visitas "),e.qZA()()()(),e.TgZ(9,"div",9)(10,"div",4),e.YNc(11,$e,3,0,"div",10),e.YNc(12,Le,2,6,"div",11),e.qZA()()(),e.BQk()}if(2&r){const t=e.oxw();e.xp6(11),e.Q6J("ngIf",0===t.data.length),e.xp6(1),e.Q6J("ngIf",t.data.length>0)}}function Xe(r,n){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",2)(2,"div",9)(3,"app-form-visita",15),e.NdJ("hideView",function(){return e.CHM(t),e.oxw().refreshView()}),e.qZA()()(),e.BQk()}}let ze=(()=>{class r{constructor(t,i,s,o,a,l,f,m,h){this.router=t,this.datePipe=i,this.route=s,this.authService=o,this.dataSecureService=a,this.sweetAlertService=l,this.profesionalService=f,this.localSecureService=m,this.emitDataService=h,this.data=[],this.columns=[],this.dom="",this.buttons=[],this.read=!0}ngOnInit(){this.validaUser()}validaUser(){var t=this;return(0,d.Z)(function*(){t.user=t.localSecureService.getValue("currentUser"),3===t.user.idPerfil?t.checkIdClient():(yield t.sweetAlertService.swalInfo("warning","\xa1Lo sentimos!","No posee los permisos necesarios para ver este \xedtem."))&&t.router.navigate(["/dashboard"])})()}checkIdClient(){const t=this.route.snapshot.queryParams.cliente;this.cliente=t?this.dataSecureService.objectDecrypt(t):null,this.cliente?this.getVisitas(!1):this.router.navigate(["/profesional"])}getColumnas(){this.dom='<"row"<"col-xl-6"B><"col-xl-6"f>><"row"<"col-xl-12"tr>><"row"<"col-xl-4"i><"col-xl-4"l><"col-xl-4"p>>',this.columns=[{title:"Fecha de visita",data:"fechaVisita",className:"dt-center",render:t=>this.datePipe.transform(t,"dd-MM-yyyy HH:mm")},{title:"Descripci\xf3n",data:"descripcion",className:"dt-center dt-body-left",orderable:!1},{title:"Estado",data:"idEstado",width:"5%",className:"dt-center",render:(t,i,s)=>`<span class="${3===t?"badge bg-success":1===t?"badge bg-info":"badge bg-danger"}">${s.estado}</span>`},{title:"Actividades",className:"dt-center",data:"idVisita",orderable:!1,defaultContent:"",render:t=>`<button class="btn bg-primary text-white btn-sm" type="submit" title="Actividades" value="${t}">\n                  <i class="c-icon fas fa-list pe-none"></i>\n                </button>`}]}action(t){const i=t.value;if(i){const s=this.dataSecureService.encrypt(this.cliente);this.router.navigate(["/profesional/actividades"],{queryParams:{cliente:s,idVisita:i}})}}getVisitas(t){var i=this;return(0,d.Z)(function*(){var s;i.sweetAlertService.swalLoading();const o={idProfesional:i.user.idUsuario,idCliente:null===(s=i.cliente)||void 0===s?void 0:s.idCliente},a=yield i.profesionalService.GetVisitas(o);i.sweetAlertService.swalClose(),a.success?(i.data=a.data,t&&i.emitDataService.tableData(i.data),i.getButtonTable(),i.getColumnas()):(401===a.code||0===a.code)&&i.authService.sessionExpired()})()}getButtonTable(){var t;this.buttons=[{extend:"excel",title:"Visitas",text:'<i class="far fa-file-excel text-white"></i> Exportar a Excel',className:"btn btn-success text-white",sheetName:`Visitas_${null===(t=this.cliente)||void 0===t?void 0:t.razonSocial}`,exportOptions:{columns:[0,1,2]}}]}refreshView(){this.getVisitas(!0),this.read=!0}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.F0),e.Y36(u.uU),e.Y36(p.gz),e.Y36(x.e),e.Y36(g.X),e.Y36(b.T),e.Y36(y),e.Y36(_.b),e.Y36(Z.B))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-visitas"]],decls:4,vars:2,consts:[[1,"container-fluid"],[4,"ngIf"],[1,"card"],[1,"card-header","mt-2"],[1,"row"],[1,"col-xl-6"],[1,"col-xl-6","text-end"],[1,"btn","btn-primary",3,"click"],[1,"c-icon","fas","fa-plus-circle"],[1,"card-body"],["class","col-xl-12 text-center display-4",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"col-xl-12","text-center","display-4"],[1,"table-responsive"],[3,"columnas","data","dom","buttons","changeAction"],[3,"hideView"]],template:function(t,i){1&t&&(e._UZ(0,"app-navbar"),e.TgZ(1,"div",0),e.YNc(2,Ge,13,2,"ng-container",1),e.YNc(3,Xe,4,0,"ng-container",1),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngIf",i.read),e.xp6(1),e.Q6J("ngIf",!i.read))},directives:[S,u.O5,A.n,He],styles:[""]}),r})();var Re=v(1188);function je(r,n){1&r&&(e.TgZ(0,"div",8)(1,"h4"),e._uU(2," Sin registros de clientes "),e.qZA()())}function Ke(r,n){if(1&r){const t=e.EpF();e.TgZ(0,"div",9)(1,"app-datatable",10),e.NdJ("changeAction",function(s){return e.CHM(t),e.oxw().action(s)}),e.qZA()()}if(2&r){const t=e.oxw();e.xp6(1),e.Tol("table-bordered border fs-6"),e.Q6J("columnas",t.columns)("data",t.data)("dom",t.dom)("buttons",t.buttons)}}const We=[{path:"",data:{title:"Profesional"},children:[{path:"",component:(()=>{class r{constructor(t,i,s,o,a,l,f){this.router=t,this.rutService=i,this.authService=s,this.dataSecureService=o,this.sweetAlertService=a,this.profesionalService=l,this.localSecureService=f,this.data=[],this.columns=[],this.dom="",this.buttons=[]}ngOnInit(){this.validaUser()}validaUser(){var t=this;return(0,d.Z)(function*(){t.usuario=t.localSecureService.getValue("currentUser"),3===t.usuario.idPerfil?t.revisarClientes():(yield t.sweetAlertService.swalInfo("warning","\xa1Lo sentimos!","No posee los permisos necesarios para ver este \xedtem."))&&t.router.navigate(["/dashboard"])})()}getColumnas(){this.dom='<"row"<"col-xl-6"B><"col-xl-6"f>><"row"<"col-xl-12"tr>><"row"<"col-xl-4"i><"col-xl-4"l><"col-xl-4"p>>',this.columns=[{title:"Cliente",data:"razonSocial",className:"dt-center dt-body-left"},{title:"Rut",data:"rut",className:"dt-center dt-body-right",render:t=>this.rutService.formateaRut(t)},{title:"Tel\xe9fono",data:"telefono",className:"dt-center dt-body-left"},{title:"Email",data:"email",className:"dt-center dt-body-left"},{title:"Direcci\xf3n",data:"direccion",className:"dt-center dt-body-left"},{title:"Comuna",data:"comuna",className:"dt-center dt-body-left"},{title:"Estado",data:"status",width:"5%",className:"dt-center",render:t=>`<span class="${1===t?"badge bg-success":"badge bg-danger"}">${1===t?"Activo":"Inactivo"}</span>`},{title:"Detalle",className:"dt-center",orderable:!1,defaultContent:"",render:(t,i,s)=>{const o=`<button class="btn bg-primary text-white btn-sm" type="submit" title="Detalle" value="${JSON.stringify(s).replace(/"/g,"'")}">\n                        <i class="c-icon fas fa-eye pe-none"></i>\n                      </button>`;return 1===s.status?o:""}}]}action(t){var i;const s=t.value?JSON.parse(null===(i=t.value)||void 0===i?void 0:i.replace(/'/g,'"')):null;if(s){const o=this.dataSecureService.encrypt(s);this.router.navigate(["/profesional/menu"],{queryParams:{cliente:o}})}}revisarClientes(){var t=this;return(0,d.Z)(function*(){t.sweetAlertService.swalLoading();const i=yield t.profesionalService.RevisarClientes(t.usuario.idUsuario);t.sweetAlertService.swalClose(),i.success?(t.data=i.data,t.getButtonTable(),t.getColumnas()):(401===i.code||0===i.code)&&t.authService.sessionExpired()})()}getButtonTable(){this.buttons=[{extend:"excel",title:"Clientes",text:'<i class="far fa-file-excel text-white"></i> Exportar a Excel',className:"btn btn-success text-white",sheetName:"Clientes",exportOptions:{columns:[0,1,2,3,4,5,6]}}]}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(p.F0),e.Y36(Re.o),e.Y36(x.e),e.Y36(g.X),e.Y36(b.T),e.Y36(y),e.Y36(_.b))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-page"]],decls:9,vars:2,consts:[[1,"container-fluid"],[1,"card"],[1,"card-header","mt-2"],[1,"text-dark"],[1,"card-body"],[1,"row"],["class","col-xl-12 text-center display-4",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"col-xl-12","text-center","display-4"],[1,"table-responsive"],[3,"columnas","data","dom","buttons","changeAction"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4",3),e._uU(4,"Clientes"),e.qZA()(),e.TgZ(5,"div",4)(6,"div",5),e.YNc(7,je,3,0,"div",6),e.YNc(8,Ke,2,6,"div",7),e.qZA()()()()),2&t&&(e.xp6(7),e.Q6J("ngIf",0===i.data.length),e.xp6(1),e.Q6J("ngIf",i.data.length>0))},directives:[u.O5,A.n],styles:[""]}),r})()},{path:"menu",component:S},{path:"capacitaciones",component:xe},{path:"visitas",component:ze},{path:"asesorias",component:oe},{path:"actividades",component:G},{path:"checklist",component:Pe},{path:"alertas",component:R},{path:"casos",component:we}]}];let et=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[p.Bz.forChild(We)],p.Bz]}),r})();var tt=v(3865);let it=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[u.ez,et,c.u5,c.UX,tt.m]]}),r})()}}]);